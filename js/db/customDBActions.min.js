function setDbConf(){currentDB=getLocalStorageValue("currentDB"),(currentDB!==getLocalStorageValue("latestDB")||null===currentDB)&&(setLocalStorage("currentDB",DB_VERSION),setLocalStorage("latestDB",DB_VERSION),latestDB=DB_VERSION)}function getSelectedIDs(){let a=[];return $(".chkChoose").each(function(){$(this).is(".is-checked")&&a.push(parseInt($(this).find("input").attr("id").replace("chk","")))}),a}function countTimetable(){let a=db.transaction(["timeTable"],"readonly").objectStore("timeTable").count();a.onsuccess=function(){0<a.result?(btnMultiple.innerHTML="<span class='mdi mdi-check-box-outline'></span>",$(".tdDel,#thDel").hide(),printTable(),dialogTimeTable.showModal()):showSnackbar(lngObject.noSpeakers)}}function printTable(){$("#speakers").empty(),results=[];let a=db.transaction(["timeTable"],"readwrite").objectStore("timeTable").openCursor();a.onsuccess=function(a){let b=a.target.result;if(b){let a="white";("yellow"===b.value.lastColor||"black"===b.value.lastColor||"white"===b.value.lastColor)&&(a="black");let c=b.value.lastColor;"black"===c&&(c="white");"green"===c?c="#60ad5e":"yellow"===c?c="#ffeb3b":"red"===c?c="#e53935":void 0;let d=getSeconds(b.value.time),e=getSeconds(b.value.min);e-30<=d&&d<e&&(c="#CCFFCC",a="black"),b.value.disqualified&&(c="black",a="white"),results.push({member:b.value.member,role:b.value.role,min:b.value.min,opt:b.value.opt,max:b.value.max,time:b.value.time,lastColor:b.value.lastColor,disqualified:b.value.disqualified}),$("#speakers").append(`<tr id="tr${b.value.id}" style="background:${c};color:${a}"><td class="tdDel mdl-data-table__cell--non-numeric hiddenObject"><label class="chkOpt chkChoose mdl-checkbox mdl-js-checkbox mdl-js-ripple-effect" for="chk${b.value.id}"><input type="checkbox" id="chk${b.value.id}" class="mdl-checkbox__input" checked="checked" /></label></td><td class="mdl-data-table__cell--non-numeric">${b.value.member}</td><td class="mdl-data-table__cell--non-numeric">${b.value.role}</td><td class="mdl-data-table__cell--non-numeric">${b.value.time}</td></tr>`),b.continue()}else refreshControls(),addCheckTaps()}}function addCheckTaps(){$("[id^=chk]").change(function(){document.getElementById("lblTickAll").MaterialCheckbox.uncheck()})}function deleteTimetable(){dialogConfirm.showModal()}function deleteByIDs(){let a=getSelectedIDs(),b=db.transaction(["timeTable"],"readwrite");for(i=0;i<a.length;i++)b.objectStore("timeTable").delete(a[i]),$(`#tr${a[i]}`).hide();refreshControls();let c=b.objectStore("timeTable").count();c.onsuccess=function(){0===c.result?(showSnackbar(lngObject.noSpeakers),dialogTimeTable.close()):addCheckTaps(),saveData()},dialogConfirm.close()}